# Case-study оптимизации

## Актуальная проблема
В нашем проекте возникла серьёзная проблема.

Наше приложенене неплохо себя показало на тестовых данных, однако оказалось, что в реальной жизни нам потребуется
загружать и отображать значительно большее количество рейсов, чем мы первоначально планировали.

От бизнеса был получен файл large.json объемом 32MB, выявивший две проблемы: 

1) Слишком медленная загрузка данных в базу
2) Слишком долгое отображение страниц веб-приложением

Попробуем решить обе проблемы. 

## Гарантия корректности работы оптимизированной программы
Напишем тест, проверяющий корректную загрузку и отображение рейсов из файла example.json. Для этого перенесем
логику обработки файла из рейк-таски в отдельный класс и напишем тест, проверяющий корректное отображение страницы
рейсов Самара - Москва

## Первая проблема - Слишком медленная загрузка данных в базу

### Метрика
Я решил использовать две метрики -  непосредственно скорость обработки файла и потребление памяти.
В проекте удобно предоставляются файлы разного размера, что позволит переходить от меньшего файла к большему по мере
оптимизации. 

### Feedback-Loop
Для того, чтобы иметь возможность быстро проверять гипотезы я выстроил `feedback-loop`,
который позволил мне получать обратную связь по эффективности сделанных изменений за 5-10 секунд

`feedback-loop` представляет из себя запуск rake таски импорта файла

- bin/rake reload_json[fixtures/small.json]

в вывод которой я добавил отчет о затраченном времени и потреблении памяти

## Вникаем в детали системы, чтобы найти главные точки роста
Для того, чтобы найти "точки роста" для оптимизации я воспользовался *инструментами, которыми вы воспользовались*

Вот какие проблемы удалось найти и решить

### Ваша находка №1
О вашей находке №1

### Ваша находка №2
О вашей находке №2

### Ваша находка №X
О вашей находке №X

## Результаты
В результате проделанной оптимизации наконец удалось обработать файл с данными.
Удалось улучшить метрику системы с *того, что у вас было в начале, до того, что получилось в конце* и уложиться в заданный бюджет.

*Какими ещё результами можете поделиться*

## Защита от регрессии производительности
Для защиты от потери достигнутого прогресса при дальнейших изменениях программы *о performance-тестах, которые вы написали*
